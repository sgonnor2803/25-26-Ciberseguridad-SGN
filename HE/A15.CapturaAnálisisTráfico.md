<h1 align="center">A15. Captura y análisis de tráfico</h1>

![Imagen Presentación](https://github.com/sgonnor2803/25-26-Ciberseguridad-SGN/blob/master/HE/images/bannerPortada.png)

***Fecha:*** 11 de febrero de 2026
<br>***Autor***: Sergio González

---
## Índice

1. ***[Introducción]()***
2. ***[Objetivos del proyecto]()***
3. ***[Herramientas y entorno de trabajo]()***
4. ***[POC 1 – Obtención de IP mediante llamada de Telegram (STUN)]()***
5. ***[POC 2 – Obtención de credenciales en autenticación web]()***
6. ***[POC 3 – Obtención de credenciales de dispositivos de red]()***
7. ***[POC 4 – Captura de credenciales en TELNET]()***
8. ***[Conclusiones]()***

---
## 1. ***Introducción***

Hoy en día gran parte de nuestra actividad se realiza a través de internet sin que siempre se tenga en cuenta cómo viajan realmente los datos por la red. Aunque muchas comunicaciones ya están cifradas, todavía existen servicios y protocolos que transmiten información sin protección.

En este proyecto se realizan varias pruebas de concepto (POC) para demostrar cómo es posible capturar y analizar tráfico de red utilizando Wireshark, y cómo un atacante podría obtener información sensible cuando se usan configuraciones inseguras o protocolos no cifrados.

Todas las pruebas se han llevado a cabo en un entorno controlado y con fines educativos, con el objetivo de concienciar sobre la importancia de aplicar medidas de seguridad en las redes.

---
## 2. ***Objetivos del proyecto***

El objetivo principal de este proyecto es aprender a capturar y analizar tráfico de red para identificar información sensible que se transmite sin cifrar o mediante protocolos inseguros.

De forma más concreta, los objetivos son:

- Comprender cómo funciona la captura de paquetes en una red.
- Analizar tráfico generado por diferentes servicios y protocolos.
- Obtener direcciones IP reales a través de llamadas P2P.
- Capturar credenciales en comunicaciones web sin cifrado.
- Interceptar usuarios y contraseñas de dispositivos de red.
- Analizar conexiones remotas mediante TELNET.
- Valorar los riesgos de seguridad derivados del uso de protocolos inseguros.

Con estas prácticas se busca adquirir una visión real de cómo un atacante puede aprovechar una mala configuración o la falta de cifrado en una red.

---
## 3. ***Herramientas y entorno de trabajo***



---
## 4. ***POC 1 – Obtención de IP mediante llamada de Telegram (STUN)***



---
## 5. ***POC 2 – Obtención de credenciales en autenticación web***

En este POC se analiza cómo viajan las credenciales de un usuario cuando se autentica en una página web, comparando una comunicación sin cifrado (HTTP) con una cifrada (HTTPS). El objetivo es comprobar de forma práctica cómo un atacante puede interceptar usuarios y contraseñas cuando no se utiliza un canal seguro, y qué ocurre cuando la comunicación está protegida mediante cifrado TLS.

Para ello se han realizado dos pruebas: una sobre una web que funciona sin HTTPS y otra sobre una web con HTTPS, capturando el tráfico con Wireshark y analizando los paquetes generados durante el proceso de autenticación.

---
### 5.1. ***Captura de usuario y contraseña en una web sin HTTPS***
---

En esta prueba se demuestra cómo es posible obtener las credenciales de un usuario cuando una página web utiliza el protocolo HTTP sin cifrado. Al no existir ningún tipo de protección en la comunicación, toda la información viaja en texto plano por la red y puede ser interceptada por un tercero mediante la captura de paquetes.

---
#### Procedimiento
---

1. Se inició Wireshark en Kali Linux y se seleccionó la interfaz de red cableada.
2. Se comenzó la captura de tráfico.
3. Desde el navegador se accedió a la página de login vulnerable.
4. Se introdujeron las credenciales:
   - Usuario: `test`
   - Contraseña: `test123`
5. Se envió el formulario de autenticación.
6. Se detuvo la captura en Wireshark.
7. Se aplicó el siguiente filtro de visualización:

```
http
```

8. Entre los paquetes mostrados se localizó la petición correspondiente al envío del formulario de autenticación (método POST).
9. Se seleccionó dicho paquete y se utilizó la opción **HTML Form URL Encoded: application/x-www-form-urlencoded** para ver el contenido completo de la comunicación.

---
#### Resultados
---

En el paquete capturado se pudo observar la siguiente información:

```
POST /index.php?r=site/login HTTP/1.1
Content-Type: application/x-www-form-urlencoded

LoginForm[username]=test
LoginForm[password]=test123
```

Las credenciales aparecen en texto plano dentro del cuerpo de la petición HTTP, lo que demuestra que cualquier atacante conectado a la misma red podría obtenerlas fácilmente.

---
#### Evidencias
---

- Captura de Wireshark mostrando el paquete POST.

<img width="1507" height="197" alt="image" src="https://github.com/user-attachments/assets/f9c3380d-c393-4ab6-b7fa-bfb59c5f4263" />

- Filtro `http` aplicado.

<img width="1505" height="142" alt="image" src="https://github.com/user-attachments/assets/8e32d015-fa70-4576-b0c7-7a1639bd4c61" />

- Ventana **HTML Form URL Encoded: application/x-www-form-urlencoded** con las credenciales visibles.

<img width="1027" height="200" alt="image" src="https://github.com/user-attachments/assets/c985f9b1-a64b-4c5a-99ed-31921a113c37" />

- Formulario de autenticación de la página web.

<img width="958" height="738" alt="image" src="https://github.com/user-attachments/assets/9b27a47f-1ba5-49c7-aafa-51abf295a1db" />

---
#### Conclusión
---

Esta prueba confirma que el uso de HTTP sin cifrado supone un grave riesgo para la seguridad, ya que permite la interceptación directa de usuarios y contraseñas. La única forma de evitar este tipo de ataques es utilizando HTTPS con cifrado TLS en todas las comunicaciones.

---
### 5.2. ***Análisis de una autenticación mediante HTTPS***
---

En este apartado se analiza qué ocurre cuando se intenta interceptar una comunicación web que utiliza HTTPS. A diferencia del protocolo HTTP, HTTPS emplea cifrado mediante TLS, lo que impide que un atacante pueda leer el contenido real de los paquetes capturados.

---
#### Procedimiento
---

1. Se inició una nueva captura de tráfico en Wireshark.
2. Se accedió desde el navegador a una página web que utiliza HTTPS.
3. Se generó tráfico accediendo a la página y escribiendo datos en el formulario.
4. Se detuvo la captura.
5. Se aplicó el filtro:

```
tls
```

6. Se seleccionó uno de los paquetes capturados y se utilizó la opción **Transport Layer Security** para analizar la comunicación.

---
#### Resultados
---

En lugar de mostrar el contenido del formulario, Wireshark indica que el tráfico está cifrado mediante **TLSv1.3**. En el campo de información aparecen mensajes como:

```
TLSv1.3 Application Data, Application Data
```

Al analizar el paquete, los datos se muestran como:

```
Encrypted Application Data
```

Esto significa que, aunque se capture el tráfico, no es posible ver el usuario ni la contraseña, ya que la información viaja cifrada.

---
#### Evidencias
---

- Captura de Wireshark mostrando tráfico TLSv1.3.

<img width="1506" height="319" alt="image" src="https://github.com/user-attachments/assets/f170aced-f1e1-48a0-801f-a86a6f15ad69" />

- Vista de **Transport Layer Security** sin datos legibles.

<img width="1017" height="331" alt="image" src="https://github.com/user-attachments/assets/551e2a62-4ff6-4e67-b7ce-9ad9c70340e9" />

---
#### Conclusión
---

Este ejercicio demuestra la diferencia entre una comunicación sin cifrar y una cifrada. Mientras que en HTTP las credenciales se pueden leer directamente, en HTTPS el uso de TLS protege la información, evitando que un atacante pueda obtener datos sensibles aunque intercepte el tráfico.

---
## 6. ***POC 3 – Obtención de credenciales de dispositivos de red***

