<h1 align="center">A12. Identificación de sistemas con NMAP</h1>

![Imagen Presentación](https://github.com/sgonnor2803/25-26-Ciberseguridad-SGN/blob/master/HE/images/bannerPortada.png)

***Fecha:*** 04 de febrero de 2026
<br>***Autor***: Sergio González

---

## Índice

1. ***[Introducción](#1-introducción)***
2. ***[Objetivo](#2-objetivo)***
3. ***[Alcance](#3-alcance)***
4. ***[Metodología](#4-metodología)***
5. ***[Resultados](#5-resultados)***
6. ***[Conclusión](#6-conclusión)***

---
## 1. ***Introducción***

En esta práctica se ha utilizado la herramienta **Nmap** para realizar un reconocimiento activo sobre un sistema objetivo, simulando una auditoría de tipo **caja negra**.

El objetivo principal es obtener información sobre el sistema, como los servicios que tiene abiertos, el sistema operativo y posibles fallos de configuración que puedan suponer un riesgo de seguridad.

Este tipo de análisis es una parte fundamental en un test de penetración, ya que permite tener una primera visión del sistema antes de continuar con otras fases más avanzadas.

---
## 2. ***Objetivo***

El objetivo de esta práctica es recopilar información del sistema objetivo mediante el uso de **Nmap** y sus scripts, con el fin de conocer cómo está expuesto en la red.

A partir de este análisis se pretende identificar el sistema operativo, los puertos abiertos, los servicios activos y posibles vulnerabilidades que puedan ser aprovechadas como vectores de ataque.

---
## 3. ***Alcance***

El análisis se ha realizado sobre una máquina de laboratorio **Metasploitable 3**, desplegada en un entorno local y destinada únicamente a prácticas de seguridad.

No se ha atacado ningún sistema real ni se ha realizado explotación, limitándose el trabajo a tareas de reconocimiento y recopilación de información mediante Nmap.

---
## 4. ***Metodología***

Para la realización de esta práctica se ha seguido una serie de pasos básicos de reconocimiento:

1. Identificación de la dirección IP del sistema objetivo.  
2. Detección del sistema operativo mediante Nmap.  
3. Escaneo de puertos TCP y UDP.  
4. Identificación de los servicios y sus versiones.  
5. Ejecución de scripts NSE para obtener información adicional.  
6. Análisis de los resultados obtenidos.

---
## 5. ***Resultados***

A continuación se muestran los resultados obtenidos tras realizar los distintos escaneos con Nmap sobre el sistema objetivo.

---
### 5.1. ***Dirección IP del objetivo***
---

La máquina analizada corresponde a la siguiente dirección IP:

#### **192.168.56.101**

---
### 5.2. ***Sistema operativo***
---

Para identificar el sistema operativo se ha utilizado el siguiente comando:

```bash
sudo nmap -O --osscan-guess 192.168.56.101
```



Según los resultados obtenidos, el sistema objetivo utiliza un sistema basado en ***Linux***.
Aunque Nmap indica que la detección puede no ser totalmente fiable, otros datos obtenidos confirman que se trata de una máquina ***Metasploitable 3*** basada en ***Ubuntu***, con servicios de Samba en ejecución.

---
### 5.3. ***Puertos y servicios abiertos***
---

Para identificar los puertos abiertos se realizó un escaneo completo de puertos TCP con el siguiente comando:

```bash
sudo nmap -p- -sS -T4 192.168.56.101
```



El sistema presenta varios puertos abiertos con servicios activos. Los principales detectados son:

| Puerto | Protocolo | Servicio |
|--------|-----------|----------|
| 21     | TCP       | FTP |
| 22     | TCP       | SSH |
| 80     | TCP       | HTTP |
| 111    | TCP       | RPCBind |
| 139    | TCP       | NetBIOS |
| 445    | TCP       | SMB |
| 8080   | TCP       | HTTP Proxy |

Además, se realizó un escaneo de los puertos UDP más comunes:

```bash
sudo nmap -sU --top-ports 100 192.168.56.101
```



Puertos UDP detectados:

| Puerto | Protocolo | Servicio |
|--------|-----------|----------|
| 111    | UDP       | rpcbind |
| 137    | UDP       | netbios-ns |

Estos servicios UDP suelen estar relacionados con funciones de red interna, por lo que también pueden suponer un punto de entrada si están mal configurados.

---
### 5.4. ***Versiones de servicios***
---

Para identificar las versiones de los servicios detectados se utilizó el siguiente comando:

```bash
sudo nmap -sV -p 21,22,80,139,445,8080 192.168.56.101
```



El objetivo de este escaneo es conocer si los servicios están actualizados o si utilizan versiones antiguas que puedan tener vulnerabilidades conocidas.

Las versiones detectadas fueron las siguientes:

| Puerto | Servicio | Versión |
|--------|----------|---------|
| 21     | FTP      | ProFTPD 1.3.5 |
| 22     | SSH      | OpenSSH 6.6.1p1 |
| 80     | HTTP     | Apache 2.4.7 |
| 139/445| SMB      | Samba 3.x – 4.x |
| 8080   | HTTP     | Jetty 8.1.7 |

Varias de estas versiones están desactualizadas, lo que aumenta el riesgo de que el sistema sea vulnerable a fallos de seguridad conocidos.

---
### 5.5. ***Comprobación de credenciales débiles***
---

Para comprobar si existían usuarios con configuraciones inseguras se utilizó el siguiente comando:

```bash
sudo nmap --script=auth 192.168.56.101
```



A partir de este escaneo se pudieron enumerar usuarios del sistema a través del servicio SMB.

Usuarios detectados:

| Usuario   | Dominio                |
|-----------|------------------------|
| chewbacca | METASPLOITABLE3-UB1404 |
| nobody    | METASPLOITABLE3-UB1404 |

Además, se detectó que el servicio SMB permite el acceso como guest, lo que supone un riesgo de seguridad al permitir conexiones sin autenticación.

---
### 5.6. ***Vulnerabilidades***
---

Para identificar vulnerabilidades conocidas se utilizó el siguiente comando:

```bash
sudo nmap --script=vuln 192.168.56.101
```



Este escaneo permitió detectar varias debilidades en los servicios web y de red del sistema.

Las vulnerabilidades más relevantes encontradas fueron:

| Vulnerabilidad | Servicio | Descripción |
|---------------|----------|-------------|
| CVE-2007-6750 (Slowloris) | Apache HTTP | Permite realizar un ataque de denegación de servicio manteniendo conexiones abiertas. |
| Regsvc DoS | SMB | Vulnerabilidad que permite provocar una denegación de servicio en el servicio regsvc. |

Además, se detectaron posibles formularios vulnerables a CSRF en distintas aplicaciones web alojadas en el servidor.

---
### 5.7. ***Servicios web detectados***
---

Para identificar los servicios web disponibles se ejecutó el siguiente comando:

```bash
sudo nmap --script=http-enum,http-title,http-methods -p 80,8080 192.168.56.101
```



El servidor web muestra un listado de directorios y varias aplicaciones accesibles desde el navegador.

Servicios y rutas detectadas:

| Ruta | Descripción |
|------|-------------|
| / | Listado de directorios |
| /phpmyadmin/ | Panel de administración de bases de datos |
| /chat/ | Aplicación web |
| /drupal/ | CMS Drupal |
| /payroll_app.php | Aplicación de nóminas |
| /uploads/ | Directorio accesible |

Estas rutas y aplicaciones representan posibles puntos de entrada para un atacante si no están correctamente protegidas.

---
### 5.8. ***Ejecución de scripts por defecto***
---

Para ampliar la información del sistema se ejecutaron los scripts por defecto de Nmap con el siguiente comando:

```bash
sudo nmap -sC 192.168.56.101
```



Este escaneo permitió obtener información adicional sobre el sistema, como el listado de directorios del servidor web, datos del sistema mediante SMB y configuraciones de seguridad.

Entre los resultados más relevantes se encuentran:

- Listado de directorios activo en el servidor web.
- Información del sistema y nombre del host.
- Acceso SMB con usuario invitado (guest).
- Configuraciones de seguridad débiles en el servicio SMB.

Estos resultados muestran que el sistema expone más información de la necesaria, lo que facilita el trabajo de un posible atacante.

---
## 6. ***Conclusión***

