<h1 align="center">A12. Identificación de sistemas con NMAP</h1>

![Imagen Presentación](https://github.com/sgonnor2803/25-26-Ciberseguridad-SGN/blob/master/HE/images/bannerPortada.png)

***Fecha:*** 04 de febrero de 2026
<br>***Autor***: Sergio González

---

## Índice

1. ***[Introducción](#1-introducción)***
2. ***[Objetivo](#2-objetivo)***
3. ***[Alcance](#3-alcance)***
4. ***[Metodología](#4-metodología)***
5. ***[Resultados](#5-resultados)***
6. ***[Conclusión](#6-conclusión)***

---
## 1. ***Introducción***

En esta práctica se ha utilizado la herramienta **Nmap** para realizar un reconocimiento activo sobre un sistema objetivo, simulando una auditoría de tipo **caja negra**.

El objetivo principal es obtener información sobre el sistema, como los servicios que tiene abiertos, el sistema operativo y posibles fallos de configuración que puedan suponer un riesgo de seguridad.

Este tipo de análisis es una parte fundamental en un test de penetración, ya que permite tener una primera visión del sistema antes de continuar con otras fases más avanzadas.

---
## 2. ***Objetivo***

El objetivo de esta práctica es recopilar información del sistema objetivo mediante el uso de **Nmap** y sus scripts, con el fin de conocer cómo está expuesto en la red.

A partir de este análisis se pretende identificar el sistema operativo, los puertos abiertos, los servicios activos y posibles vulnerabilidades que puedan ser aprovechadas como vectores de ataque.

---
## 3. ***Alcance***

El análisis se ha realizado sobre una máquina de laboratorio **Metasploitable 3**, desplegada en un entorno local y destinada únicamente a prácticas de seguridad.

No se ha atacado ningún sistema real ni se ha realizado explotación, limitándose el trabajo a tareas de reconocimiento y recopilación de información mediante Nmap.

---
## 4. ***Metodología***

Para la realización de esta práctica se ha seguido una serie de pasos básicos de reconocimiento:

1. Identificación de la dirección IP del sistema objetivo.  
2. Detección del sistema operativo mediante Nmap.  
3. Escaneo de puertos TCP y UDP.  
4. Identificación de los servicios y sus versiones.  
5. Ejecución de scripts NSE para obtener información adicional.  
6. Análisis de los resultados obtenidos.

---
## 5. ***Resultados***

A continuación se muestran los resultados obtenidos tras realizar los distintos escaneos con Nmap sobre el sistema objetivo.

---
### 5.1. ***Dirección IP del objetivo***
---

Tras desplegar la máquina objetivo y verificar su conectividad en la red, se identificó la dirección IP asignada al sistema a analizar.

La máquina objetivo corresponde a la siguiente dirección IP:

#### **192.168.56.101**

---
### 5.2. ***Sistema operativo***
---

Para identificar el sistema operativo se ha utilizado el siguiente comando:

```bash
nmap -O --osscan-guess 192.168.56.101
```

<img width="1107" height="476" alt="image" src="https://github.com/user-attachments/assets/a5bb2830-282e-440c-9bd8-6f8d8fb7a1b4" />

Según los resultados obtenidos, Nmap indica que el sistema se ejecuta sobre un kernel ***Linux 2.4.x***.

El propio escaneo muestra una advertencia indicando que la detección puede no ser totalmente fiable, ya que no se han encontrado suficientes puertos cerrados para confirmar el sistema con precisión.

Aun así, se puede afirmar que el sistema está basado en Linux, y más adelante, mediante otros escaneos (SMB), se confirma que se trata de una máquina de laboratorio ***Metasploitable 3*** basada en Ubuntu.

---
### 5.3. ***Puertos y servicios abiertos***
---

Para identificar los puertos abiertos se realizó un escaneo completo de puertos TCP con el siguiente comando:

```bash
nmap -p- --min-rate 5000 192.168.56.101
```

<img width="1105" height="389" alt="image" src="https://github.com/user-attachments/assets/6489011b-7f52-40a2-a954-0602ff472e8d" />

El sistema presenta varios puertos abiertos con servicios activos. Los principales detectados son:

| Puerto | Protocolo | Servicio |
|--------|-----------|----------|
| 21     | TCP       | FTP |
| 22     | TCP       | SSH |
| 80     | TCP       | HTTP |
| 111    | TCP       | RPCBind |
| 139    | TCP       | NetBIOS |
| 445    | TCP       | SMB |
| 3306   | TCP       | MySQL |
| 8080   | TCP       | HTTP Proxy |

Además, se realizó un escaneo de los puertos UDP más comunes:

```bash
nmap -sU --min-rate 5000 --top-ports 100 192.168.56.101
```

<img width="1106" height="298" alt="image" src="https://github.com/user-attachments/assets/1c8f4374-4389-4dbf-85d6-7f4909c5d743" />

Puertos UDP detectados:

| Puerto | Protocolo | Servicio |
|--------|-----------|----------|
| 111    | UDP       | rpcbind |
| 137    | UDP       | netbios-ns |

Estos servicios UDP están relacionados con funciones internas de red, por lo que también pueden suponer un punto de entrada si están mal configurados.

---
### 5.4. ***Versiones de servicios***
---

Para identificar las versiones de los servicios detectados se utilizó el siguiente comando:

```bash
nmap -p 21,22,80,111,139,445,3306,8080 --min-rate 5000 -sV 192.168.56.101
```

<img width="1104" height="420" alt="image" src="https://github.com/user-attachments/assets/7768748d-b880-4e97-8ad9-c5ede040aed3" />

El objetivo de este escaneo es conocer si los servicios están actualizados o si utilizan versiones antiguas que puedan tener vulnerabilidades conocidas.

Las versiones detectadas fueron las siguientes:

| Puerto | Servicio | Versión |
|--------|----------|---------|
| 21     | FTP      | ProFTPD 1.3.5 |
| 22     | SSH      | OpenSSH 6.6.1p1 |
| 80     | HTTP     | Apache httpd 2.4.7 |
| 111    | RPCBind  | rpcbind 2-4 |
| 139/445| SMB      | Samba smbd 3.x – 4.x |
| 3306   | MySQL    | MySQL (unauthorized) |
| 8080   | HTTP     | Jetty 8.1.7 |

Varias de estas versiones están desactualizadas, lo que aumenta el riesgo de que el sistema sea vulnerable a fallos de seguridad conocidos.

---
### 5.5. ***Comprobación de credenciales débiles***
---

Para comprobar si existían usuarios con configuraciones inseguras o métodos de autenticación débiles se utilizó el siguiente comando:

```bash
sudo nmap --script=auth -T5 192.168.56.101
```

<img width="1106" height="591" alt="image" src="https://github.com/user-attachments/assets/d16776e8-ed1a-4371-97c6-55a194ad9d53" />

Este escaneo permitió obtener información sobre los métodos de autenticación activos y comprobar si existían credenciales vacías o accesos inseguros.

A partir de los resultados, se pudieron enumerar usuarios del sistema a través del servicio SMB.

Usuarios detectados:

| Usuario   | Dominio                |
|-----------|------------------------|
| chewbacca | METASPLOITABLE3-UB1404 |
| nobody    | METASPLOITABLE3-UB1404 |

Además, el servicio SMB permite acceso como guest, lo que supone un riesgo de seguridad al permitir conexiones sin autenticación.

Por otro lado, el servicio MySQL no permite conexiones externas con contraseña vacía, aunque sigue siendo un servicio expuesto que puede ser objetivo de ataques.

---
### 5.6. ***Vulnerabilidades***
---

Para identificar vulnerabilidades conocidas se utilizó el siguiente comando:

```bash
sudo nmap --script=vuln -T5 192.168.56.101
```

<img width="1106" height="821" alt="image" src="https://github.com/user-attachments/assets/df6a8d33-b55f-48f2-ba35-dea947879269" />
<img width="1105" height="833" alt="image" src="https://github.com/user-attachments/assets/a987f586-df93-445a-aa00-ed875b198214" />
<img width="1110" height="389" alt="image" src="https://github.com/user-attachments/assets/5b16145b-ce64-4718-8b22-9df4a3fc16b6" />

Este escaneo permitió detectar múltiples vulnerabilidades tanto en los servicios web como en los servicios de red del sistema.

Las vulnerabilidades más relevantes encontradas fueron:

| Vulnerabilidad | Servicio | Descripción |
|---------------|----------|-------------|
| CVE-2007-6750 (Slowloris) | Apache HTTP | Permite realizar un ataque de denegación de servicio manteniendo conexiones abiertas. |
| CVE-2009-3103 (SMBv2) | SMB | Permite ejecutar código remoto o provocar una caída del sistema mediante paquetes manipulados. |
| Regsvc DoS | SMB | Vulnerabilidad que permite provocar una denegación de servicio en el servicio regsvc. |
| SQL Injection (posible) | Apache / phpMyAdmin | Se detectaron múltiples parámetros vulnerables a inyección SQL. |
| DOM Based XSS | phpMyAdmin | Posible ejecución de código JavaScript en el navegador de la víctima. |
| CSRF | Aplicaciones web | Formularios vulnerables en varias rutas del servidor. |

Además, se detectaron directorios expuestos y aplicaciones accesibles como phpMyAdmin, así como listados de directorios habilitados en el servidor web, lo que facilita la enumeración de recursos.

Estos resultados indican que el sistema presenta un nivel de exposición muy alto y múltiples vectores de ataque que podrían ser explotados por un atacante real.

---
### 5.7. ***Servicios web detectados***
---

Para identificar los servicios web disponibles se ejecutó el siguiente comando:

```bash
sudo nmap --script=http-enum,http-title,http-methods -p 80,8080 -T5 192.168.56.101
```

<img width="1106" height="428" alt="image" src="https://github.com/user-attachments/assets/f66601ca-bc18-4325-a42d-b78e20b5fc5b" />

El servidor web muestra un listado de directorios y varias aplicaciones accesibles desde el navegador.

Servicios y rutas detectadas:

| Ruta | Descripción |
|------|-------------|
| / | Listado de directorios en Apache |
| /phpmyadmin/ | Panel de administración de bases de datos |
| /uploads/ | Directorio accesible con listado |

Además, se detectó que el servidor permite los métodos GET, POST, OPTIONS y HEAD, lo que confirma que se trata de un servicio web completamente funcional.

Estas rutas representan posibles puntos de entrada si no están correctamente protegidas.

---
### 5.8. ***Ejecución de scripts por defecto***
---

Para ampliar la información del sistema se ejecutaron los scripts por defecto de Nmap con el siguiente comando:

```bash
nmap -p- -sC --min-rate 5000 192.168.56.101
```

<img width="768" height="811" alt="image" src="https://github.com/user-attachments/assets/7d0d1eb4-9ef8-4059-83c8-d4fc4037f7b0" />

Este escaneo permitió obtener información adicional sobre los servicios expuestos y la configuración interna del sistema.

Entre los resultados más relevantes se encuentran:

- **Listado de directorios activo** en el servidor web (chat, drupal, phpmyadmin, payroll_app.php).
- **Información detallada de RPC** mediante rpcinfo.
- **Acceso SMB como usuario invitado (guest)**.
- **Nombre del host y sistema**: metasploitable3-ub1404 (Samba sobre Ubuntu).
- **Firma de mensajes SMB deshabilitada**, lo que supone una configuración insegura.
- **Sincronización de hora y datos NetBIOS** accesibles.

Estos resultados muestran que el sistema expone información sensible que podría facilitar tanto la enumeración como ataques posteriores.

---
## 6. ***Conclusión***

La práctica ha permitido comprobar cómo **Nmap** permite obtener información clave sobre un sistema, como puertos abiertos, servicios, versiones y posibles vulnerabilidades. 

Se ha observado que la máquina objetivo presenta servicios desactualizados y configuraciones débiles que podrían ser aprovechadas por un atacante.

En resumen, este ejercicio muestra la importancia de mantener los sistemas actualizados y correctamente configurados para reducir riesgos de seguridad.
